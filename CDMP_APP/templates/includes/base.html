{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="{% static 'CDMP_APP/css/style.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet"> 
    <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
    {%block head-content%}{%endblock%}
</head>
<body>
    <nav id="nav" class="navigation sidenav">
        <div class="links">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <h4>Menu</h4>
            <ul>
                <li>
                    <a href="{% url 'index' %}">Home</a>  <canvas class="home" width="50" height="50"></canvas>
                </li>
                <li>
                    <a href="{% url 'sair' %}">Sair</a>  <canvas class="sair" width="50" height="50"></canvas>
                </li>
                <li><a href="{% url 'add_despesa' %}">Adicionar despesa</a> <canvas class="despesa" width="50" height="50"></canvas>
                </li>
                <li><a href="{% url 'add_deposito' %}">Adicionar deposito</a> <canvas class="deposito" width="50" height="50"></canvas>
                </li>
                <li><a href="{% url 'edit_teto' %}">Editar teto de gastos</a> <canvas width="50" height="50"></canvas>
                </li>
                <li><a href="{% url 'add_categoria' %}">Cadastrar Categoria</a> <canvas width="50" height="50"></canvas>
                </li>
            </ul>
        </div>
        <div class="links">
            <h4>Despesas</h4>
            <ul>
                <li><a href="{% url 'view_all_gastos' %}">Pesquisar por nome</a> <canvas width="50" height="50"></canvas>
                </li>
                <li> <a href="{% url 'despesa_por_categoria' %}">Pesquisar por categoria</a> <canvas width="50" height="50"></canvas>
                </li>
                <li> <a href="{% url 'despesa_por_data' %}">Pesquisar por data</a> <canvas width="50" height="50"></canvas>
                </li>
            </ul>
        </div>
    </nav>
    <section class="greater-data">
        <button class="show-menu" onclick="openNav()">
            <img src="{% static 'CDMP_APP/imgs/menu.png' %}" alt="" srcset="" width="20" height="20">
        </button>
        {%block greater-data%} {%endblock%}
        
    </section>
    <section class="mini-data">
        <h3>Ultimas atividades</h3>
            <ul class="ultimas-atividades">
                {% if historico_cliente %}
                    {% for historico in historico_cliente %}
                        <li>
                            <canvas width="50" height="50"></canvas>
                            <a href="{% url 'view_history' id=historico.pk %}" ><p>{{historico.operacao}}</p></a>
                            <!--<p>{{historico.data_operacao}}</p>-->
                        </li>
                    {% endfor%}
                {% endif %}
            </ul>
            <canvas id="monitor"></canvas>
    </section>
    {%block other-content%}{%endblock%}
    <script>
        function openNav() {
        document.getElementById("nav").style.width = "100%";
        }

        /* Set the width of the side navigation to 0 */
        function closeNav() {
        document.getElementById("nav").style.width = "0";
        } 
    </script>
    <script>
        //animações
        //adicionar deposito
        let deposito_canvas = document.querySelector(".deposito")
        let context = deposito_canvas.getContext('2d')
        let coins = new Image()
        coins.src = `/static/CDMP_APP/imgs/Sprites/coins/coins_16x16.png`
        let index_coin=0
        setInterval(()=>{
            index_coin++
            if(index_coin > 14){
                index_coin=0
            }
            context.imageSmoothingEnabled = false
            context.clearRect(0, 0, deposito_canvas.width, deposito_canvas.height);
            context.drawImage(coins,
            16*index_coin,0,
            16,16,
            0,0,
            16*3,16*3)
        },100)
        //sair
        let sair_canvas = document.querySelector(".sair")
        let context_sair = sair_canvas.getContext('2d')
        let pop_sair = new Image()
        pop_sair.src = `/static/CDMP_APP/imgs/Sprites/pop_up/pipo-popupemotes142.png`
        let index_pop_up=0
        setInterval(()=>{
            index_pop_up++
            if(index_pop_up > 2){
                index_pop_up=0
            }
            context_sair.imageSmoothingEnabled = false
            context_sair.clearRect(0, 0, sair_canvas.width, sair_canvas.height);
            context_sair.drawImage(
            pop_sair,
            (pop_sair.width/3)*index_pop_up,0,
            (pop_sair.width/3),(pop_sair.height),
            0,0,
            (pop_sair.width/3)*1.5,pop_sair.height*1.5)
        },250)
        //home
        let home_canvas = document.querySelector(".home")
        let context_home = home_canvas.getContext('2d')
        let pop_home = new Image()
        pop_home.src = `/static/CDMP_APP/imgs/Sprites/pop_up/pipo-popupemotes140.png`
        let index_pop_up_home=0
        setInterval(()=>{
            index_pop_up_home++
            if(index_pop_up_home > 2){
                index_pop_up_home=0
            }
            context_home.imageSmoothingEnabled = false
            context_home.clearRect(0, 0, home_canvas.width, home_canvas.height);
            context_home.drawImage(
            pop_home,
            (pop_home.width/3)*index_pop_up_home,0,
            (pop_home.width/3),(pop_home.height),
            0,0,
            (pop_home.width/3)*1.5,pop_home.height*1.5)
        },250)
        //adicionar despesa
        let despesa_canvas = document.querySelector(".home")
        let context_despesa = despesa_canvas.getContext('2d')
        let coin_img = new Image()
        coin_img.src = `/static/CDMP_APP/imgs/Sprites/pop_up/pipo-popupemotes140.png`
        let index_coin_move=0
        let coin_pos_y =0
        setInterval(()=>{
            index_coin_move++
            coin_pos_y+=10
            if(index_coin_move > 2){
                coin_pos_y = index_coin_move >= 1 ? 10: coin_pos_y
                index_coin_move=0
            }
            context_despesa.imageSmoothingEnabled = false
            context_despesa.clearRect(0, 0, despesa_canvas.width, despesa_canvas.height);
            context_despesa.drawImage(
            coin_img,
            0,0,
            coin_img.width,coin_img.height,
            coin_pos_y,0,
            coin_img.width*1.5,coin_img.height*1.5)
        },250)
    </script>
</body>
</html>